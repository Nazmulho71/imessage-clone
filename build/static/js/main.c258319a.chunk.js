(this["webpackJsonpimessage-clone"]=this["webpackJsonpimessage-clone"]||[]).push([[0],{59:function(e,t,c){},67:function(e,t,c){},68:function(e,t,c){},69:function(e,t,c){},70:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},74:function(e,t,c){"use strict";c.r(t);var a=c(5),n=c(2),s=c.n(n),i=c(20),o=c.n(i),r=(c(59),c(14)),d=c(24),l=Object(d.b)({name:"user",initialState:{user:null},reducers:{login:function(e,t){e.user=t.payload},logout:function(e){e.user=null}}}),u=l.actions,j=u.login,h=u.logout,b=function(e){return e.user.user},m=l.reducer,O=c(26),p=O.a.initializeApp({apiKey:"AIzaSyCZXz9pXIB9BFACZFVOMgtFfOw0l7k1ubY",authDomain:"imessage-clone-17697.firebaseapp.com",projectId:"imessage-clone-17697",storageBucket:"imessage-clone-17697.appspot.com",messagingSenderId:"850686870912",appId:"1:850686870912:web:2ea025a9cce83f1338ed65",measurementId:"G-4YMH7Z069Y"}).firestore(),f=O.a.auth(),v=new O.a.auth.GoogleAuthProvider,x=p,g=c(22),N=c(92),I=c(88),w=c(87),_=c(89),y=Object(d.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,t){e.chatId=t.payload.chatId,e.chatName=t.payload.chatName}}}),S=y.actions.setChat,C=function(e){return e.chat.chatName},k=function(e){return e.chat.chatId},Y=y.reducer,J=c(48);c(67);var Z=function(e){var t,c,s,i,o=e.id,d=e.chatName,l=Object(r.b)(),u=Object(n.useState)([]),j=Object(g.a)(u,2),h=j[0],b=j[1];return Object(n.useEffect)((function(){x.collection("chats").doc(o).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return b(e.docs.map((function(e){return e.data()})))}))}),[o]),Object(a.jsxs)("div",{onClick:function(){return l(S({chatId:o,chatName:d}))},className:"sidebarChat",children:[Object(a.jsx)(N.a,{src:null===(t=h[0])||void 0===t?void 0:t.photo}),Object(a.jsxs)("div",{className:"sidebarChat__info",children:[Object(a.jsx)("h3",{children:d}),Object(a.jsx)("p",{children:null===(c=h[0])||void 0===c?void 0:c.message}),Object(a.jsx)("small",{children:J.a(new Date(null===(s=h[0])||void 0===s||null===(i=s.timestamp)||void 0===i?void 0:i.toDate()).toLocaleString())})]})]})};c(68);var D=function(){var e=Object(r.c)(b),t=Object(n.useState)([]),c=Object(g.a)(t,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){x.collection("chats").onSnapshot((function(e){return i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(a.jsxs)("div",{className:"sidebar",children:[Object(a.jsxs)("div",{className:"sidebar__header",children:[Object(a.jsx)(N.a,{onClick:function(){return f.signOut()},src:e.photo,className:"sidebar__avatar"}),Object(a.jsxs)("div",{className:"sidebar__input",children:[Object(a.jsx)(w.a,{}),Object(a.jsx)("input",{placeholder:"Search"})]}),Object(a.jsx)(I.a,{variant:"outlined",className:"sidebar__inputButton",children:Object(a.jsx)(_.a,{onClick:function(){var e=prompt("Please enter a chat name");e&&x.collection("chats").add({chatName:e})}})})]}),Object(a.jsx)("div",{className:"sidebar__chats",children:s.map((function(e){var t=e.id,c=e.data.chatName;return Object(a.jsx)(Z,{id:t,chatName:c},t)}))})]})},L=c(47),M=c(90),T=(c(69),Object(n.forwardRef)((function(e,t){e.id;var c=e.contents,n=c.timestamp,s=(c.displayName,c.email),i=c.message,o=c.photo,d=(c.uid,Object(r.c)(b));return Object(a.jsxs)("div",{ref:t,className:"message ".concat(d.email===s&&"message__sender"),children:[Object(a.jsx)(N.a,{className:"message__photo",src:o}),Object(a.jsx)("p",{children:i}),Object(a.jsx)("small",{children:new Date(null===n||void 0===n?void 0:n.toDate()).toLocaleString()})]})})));c(70);var z=function(){var e=Object(r.c)(b),t=Object(n.useState)(""),c=Object(g.a)(t,2),s=c[0],i=c[1],o=Object(r.c)(C),d=Object(r.c)(k),l=Object(n.useState)([]),u=Object(g.a)(l,2),j=u[0],h=u[1];return Object(n.useEffect)((function(){d&&x.collection("chats").doc(d).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[d]),Object(a.jsxs)("div",{className:"chat",children:[Object(a.jsxs)("div",{className:"chat__header",children:[Object(a.jsxs)("h4",{children:["To: ",Object(a.jsx)("span",{className:"chat__name",children:o})]}),Object(a.jsx)("strong",{children:"Details"})]}),Object(a.jsx)("div",{className:"chat__messages",children:Object(a.jsx)(L.a,{children:j.map((function(e){var t=e.id,c=e.data;return Object(a.jsx)(T,{contents:c},t)}))})}),Object(a.jsxs)("div",{className:"chat__input",children:[Object(a.jsxs)("form",{children:[Object(a.jsx)("input",{value:s,onChange:function(e){return i(e.target.value)},placeholder:"iMessage",type:"text"}),Object(a.jsx)("button",{onClick:function(t){t.preventDefault(),x.collection("chats").doc(d).collection("messages").add({timestamp:O.a.firestore.FieldValue.serverTimestamp(),message:s,uid:e.uid,photo:e.photo,email:e.email,displayName:e.displayName}),i("")},children:"Send Message"})]}),Object(a.jsx)(I.a,{children:Object(a.jsx)(M.a,{className:"chat__mic"})})]})]})};c(71);var B=function(){return Object(a.jsxs)("div",{className:"imessage",children:[Object(a.jsx)(D,{}),Object(a.jsx)(z,{})]})},W=c(91);c(72);var A=function(){return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsxs)("div",{className:"login__logo",children:[Object(a.jsx)("img",{src:"https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/a60c69b4-dbdc-49e3-b152-43bbdbfb0160/d6dy6qy-19e320f2-932f-4549-8050-2b7fb9289eda.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOiIsImlzcyI6InVybjphcHA6Iiwib2JqIjpbW3sicGF0aCI6IlwvZlwvYTYwYzY5YjQtZGJkYy00OWUzLWIxNTItNDNiYmRiZmIwMTYwXC9kNmR5NnF5LTE5ZTMyMGYyLTkzMmYtNDU0OS04MDUwLTJiN2ZiOTI4OWVkYS5wbmcifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6ZmlsZS5kb3dubG9hZCJdfQ.AQSIo8n9g9HHLZFVdCwqbDOjFg9DwZI35LCTIuLgtEw",alt:""}),Object(a.jsx)("h1",{children:"iMessage"})]}),Object(a.jsx)(W.a,{onClick:function(){f.signInWithPopup(v).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};c(73);var F=function(){var e=Object(r.c)(b),t=Object(r.b)();return Object(n.useEffect)((function(){f.onAuthStateChanged((function(e){t(e?j({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName}):h())}))}),[]),Object(a.jsx)("div",{className:"app",children:e?Object(a.jsx)(B,{}):Object(a.jsx)(A,{})})},E=Object(d.a)({reducer:{user:m,chat:Y}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(r.a,{store:E,children:Object(a.jsx)(F,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[74,1,2]]]);
//# sourceMappingURL=main.c258319a.chunk.js.map